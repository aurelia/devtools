<div id="au-dev-root" class="devtools-root ${isDarkTheme ? 'dark' : ''}">
  <nav class="tab-bar">
    <button
      repeat.for="tab of tabs"
      class="tab-button ${activeTab === tab.id ? 'active' : ''}"
      click.trigger="switchTab(tab.id)"
    >
      <span class="tab-icon">${tab.icon}</span>
      <span class="tab-label">${tab.label}</span>
    </button>
  </nav>

  <main class="devtools-main">
    <!-- Main Tab - Split Pane Layout (All/Components/Attributes) -->
    <div if.bind="!isExternalTabActive" class="h-full flex flex-col">
      <div class="components-split-pane">
        <!-- Left Panel - Component Tree -->
        <div class="components-tree-panel">
          <div class="components-toolbar">
            <div class="toolbar-top">
              <!-- Auto-sync toggle (icon-only) -->
              <button
                class="toolbar-button icon-only ${followChromeSelection ? 'active' : ''}"
                click.trigger="toggleFollowChromeSelection()"
                title="Auto-sync with Elements ($0)"
                aria-label="Toggle auto-sync with Elements"
              >
                <!-- Chain link icon -->
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M10.59 13.41a1.996 1.996 0 0 1 0-2.82l2.83-2.83a2 2 0 1 1 2.83 2.83l-1 1 1.41 1.41 1-1a4 4 0 1 0-5.66-5.66l-2.83 2.83a4 4 0 0 0 0 5.66l.42.42 1.41-1.41-.41-.42zm2.82-2.82a1.996 1.996 0 0 1 0 2.82l-2.83 2.83a2 2 0 1 1-2.83-2.83l1-1-1.41-1.41-1 1a4 4 0 1 0 5.66 5.66l2.83-2.83a4 4 0 0 0 0-5.66l-.42-.42-1.41 1.41.41.42z"/>
                </svg>
              </button>

              <!-- Pick element (icon-only) -->
              <button
                if.bind="activeTab === 'all'"
                class="toolbar-button icon-only element-picker ${isElementPickerActive ? 'active' : ''}"
                click.trigger="toggleElementPicker()"
                title="Select component from page"
                aria-label="Select component from page"
              >
                <!-- Target icon -->
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 8a4 4 0 1 0 0 8 4 4 0 0 0 0-8zm0-6a1 1 0 0 1 1 1v2.07A7.002 7.002 0 0 1 19.93 11H22a1 1 0 1 1 0 2h-2.07A7.002 7.002 0 0 1 13 19.93V22a1 1 0 1 1-2 0v-2.07A7.002 7.002 0 0 1 4.07 13H2a1 1 0 1 1 0-2h2.07A7.002 7.002 0 0 1 11 4.07V2a1 1 0 0 1 1-1zM12 6a6 6 0 1 0 .001 12.001A6 6 0 0 0 12 6z"/>
                </svg>
              </button>

              <!-- Reveal in Elements (icon-only) -->
              <button
                class="toolbar-button icon-only"
                if.bind="selectedComponentId"
                click.trigger="revealInElements()"
                title="Reveal in Elements panel"
                aria-label="Reveal in Elements panel"
              >
                <!-- Eye icon -->
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm0-8a3 3 0 1 0 .001 6.001A3 3 0 0 0 12 9z"/>
                </svg>
              </button>

              <!-- Refresh (icon-only) -->
              <button
                class="toolbar-button icon-only ${isRefreshing ? 'spinning' : ''}"
                click.trigger="refreshComponents()"
                title="Refresh components"
                aria-label="Refresh components"
              >
                <svg class="refresh-icon" width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M17.65 6.35A7.95 7.95 0 0 0 12 4V1L7 6l5 5V7a6 6 0 1 1-6 6H4a8 8 0 1 0 13.65-6.65z" />
                </svg>
              </button>
              <div class="view-mode-toggle" role="group" aria-label="Component view mode">
                <button
                  class="toolbar-button icon-only ${viewMode === 'tree' ? 'active' : ''}"
                  click.trigger="setViewMode('tree')"
                  title="Tree view"
                  aria-label="Tree view"
                  aria-pressed="${viewMode === 'tree'}"
                >
                  <span class="view-mode-icon">üå≥</span>
                </button>
                <button
                  class="toolbar-button icon-only ${viewMode === 'list' ? 'active' : ''}"
                  click.trigger="setViewMode('list')"
                  title="List view"
                  aria-label="List view"
                  aria-pressed="${viewMode === 'list'}"
                >
                  <span class="view-mode-icon">‚ò∞</span>
                </button>
              </div>
              <span
                class="component-count"
                if.bind="visibleComponentNodes.length"
              >
                ${visibleComponentNodes.length}${searchQuery ? ' of ' +
                totalComponentNodeCount : ''} ${activeTab === 'all' ? 'component' : activeTab.slice(0, -1)}${visibleComponentNodes.length
                !== 1 ? 's' : ''}
              </span>
            </div>
            <div class="search-container">
              <svg
                class="search-icon"
                width="14"
                height="14"
                viewBox="0 0 14 14"
                fill="currentColor"
              >
                <path
                  d="M10 6A4 4 0 1 1 2 6a4 4 0 0 1 8 0zM6 10a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm4.7 2.7L13 10.4 10.4 13l-2.3-2.3"
                />
              </svg>
              <input
                class="search-input"
                type="text"
                placeholder="Search components..."
                value.bind="searchQuery"
                input.trigger="filterComponents()"
              />
              <button
                class="clear-search"
                if.bind="searchQuery"
                click.trigger="clearSearch()"
                title="Clear search"
              >
                <svg
                  width="12"
                  height="12"
                  viewBox="0 0 12 12"
                  fill="currentColor"
                >
                  <path
                    d="M6 4.586L9.293 1.293 10.707 2.707 7.414 6l3.293 3.293-1.414 1.414L6 7.414 2.707 10.707 1.293 9.293 4.586 6 1.293 2.707 2.707 1.293 6 4.586z"
                  />
                </svg>
              </button>
            </div>
          </div>

          <div class="flex-1 overflow-y-auto">
            <div if.bind="detectionState === 'checking'" class="empty-components">
              <div class="empty-icon">üîç</div>
              <h3>Looking for Aurelia...</h3>
              <p>
                Scanning the page for Aurelia v1 or v2 applications.
              </p>
            </div>

            <div if.bind="detectionState === 'not-found'" class="empty-components">
              <div class="empty-icon">‚ö°</div>
              <h3>No Aurelia application detected</h3>
              <p>
                This page does not appear to have an Aurelia v1 or v2 application running.
                The Aurelia DevTools require an active Aurelia application to function.
              </p>
              <button
                class="refresh-button"
                click.trigger="recheckAurelia()"
              >
                Check Again
              </button>
            </div>

            <div if.bind="detectionState === 'disabled'" class="empty-components">
              <div class="empty-icon">üõë</div>
              <h3>Aurelia DevTools disabled</h3>
              <p>
                This application has opted out of Aurelia DevTools inspections.
                Remove the opt-out flag on the page to re-enable the inspector.
              </p>
            </div>

            <div if.bind="aureliaDetected && !componentTree.length" class="empty-components">
              <div class="empty-icon">üå≤</div>
              <h3>No Aurelia components found</h3>
              <p>
                Make sure the page has Aurelia components and they are properly
                registered.
              </p>
              <button
                class="refresh-button"
                click.trigger="loadAllComponents()"
              >
                Refresh Components
              </button>
            </div>

            <div
              if.bind="aureliaDetected && componentTree.length && !visibleComponentNodes.length && searchQuery"
              class="empty-components"
            >
              <div class="empty-icon">üîç</div>
              <h3>No matching components</h3>
              <p>
                Try a different search term or clear the search to see all
                components.
              </p>
              <button class="refresh-button" click.trigger="clearSearch()">
                Clear Search
              </button>
            </div>

            <div class="component-tree" if.bind="aureliaDetected && visibleComponentNodes.length">
              <div
                repeat.for="item of visibleComponentNodes"
                class="component-tree-row"
              >
                <div
                  class="component-item ${selectedComponentId === item.node.id ? 'selected' : ''}"
                  style="padding-left: ${(viewMode === 'list' ? 0 : item.depth * 18)}px"
                  title="${item.node.domPath || item.node.name}"
                  click.trigger="selectComponent(item.node.id)"
                  mouseenter.trigger="highlightComponent(item.node)"
                  mouseleave.trigger="unhighlightComponent()"
                >
                  <button
                    class="expand-toggle"
                    css="visibility: ${(item.node.children.length && viewMode === 'tree') ? 'visible' : 'hidden'}"
                    disabled.bind="viewMode === 'list'"
                    click.trigger="handleExpandToggle(item.node, $event)"
                  >
                    <svg
                      width="8"
                      height="8"
                      viewBox="0 0 8 8"
                      class="expand-icon ${item.node.expanded ? 'expanded' : ''}"
                    >
                      <path d="M2 2 L6 4 L2 6 Z" fill="currentColor" />
                    </svg>
                  </button>
                  <span class="component-icon ${item.node.type}">
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 12 12"
                      fill="currentColor"
                    >
                      <path
                        if.bind="item.node.type === 'custom-element'"
                        d="M2 2h8v2H2V2zm0 3h8v5H2V5z"
                      />
                      <path
                        if.bind="item.node.type === 'custom-attribute'"
                        d="M6 1L1 6l5 5 5-5-5-5z"
                      />
                    </svg>
                  </span>
                  <span class="component-name ${item.node.type}">
                    <span if.bind="item.node.type === 'custom-element'">&lt;${item.node.name}&gt;</span>
                    <span if.bind="item.node.type === 'custom-attribute'">@${item.node.name}</span>
                  </span>
                  <span
                    if.bind="item.node.data.kind === 'element' && item.node.data.info.customAttributesInfo.length"
                    class="component-badge"
                    >${item.node.data.info.customAttributesInfo.length}</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Vertical Splitter -->
        <div class="splitter-vertical"></div>

        <!-- Right Panel - Component Details -->
        <div class="component-details-panel">
          <div if.bind="!selectedComponentId" class="empty-details">
            <div class="empty-details-content">
              <div class="empty-details-icon">
                <svg
                  width="48"
                  height="48"
                  viewBox="0 0 48 48"
                  fill="currentColor"
                  opacity="0.3"
                >
                  <path d="M8 8h32v6H8V8zm0 10h32v22H8V18z" />
                </svg>
              </div>
              <h3>Select a component</h3>
              <p>
                Choose a component from the tree to view its properties and
                details.
              </p>
            </div>
          </div>

          <div
            if.bind="selectedComponentId && selectedElement"
            class="component-details"
          >
            <nav class="component-breadcrumbs" if.bind="breadcrumbSegments.length">
              <template repeat.for="crumb of breadcrumbSegments; index as i">
                <button
                  class="breadcrumb-item ${crumb.type} ${crumb.id === selectedComponentId ? 'active' : ''}"
                  click.trigger="selectComponent(crumb.id)"
                >
                  ${crumb.label}
                </button>
                <span class="breadcrumb-separator" if.bind="i < breadcrumbSegments.length - 1">‚Ä∫</span>
              </template>
            </nav>
            <div class="details-header">
              <div class="selected-component-info">
                <span
                  class="component-icon ${selectedNodeType}"
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 12 12"
                    fill="currentColor"
                  >
                    <path
                      if.bind="selectedNodeType === 'custom-element'"
                      d="M2 2h8v2H2V2zm0 3h8v5H2V5z"
                    />
                    <path
                      if.bind="selectedNodeType === 'custom-attribute'"
                      d="M6 1L1 6l5 5 5-5-5-5z"
                    />
                  </svg>
                </span>
                <span class="selected-component-name">
                  <span if.bind="selectedNodeType === 'custom-element'">
                    &lt;${selectedElement ? selectedElement.name : 'component'}&gt;
                  </span>
                  <span if.bind="selectedNodeType === 'custom-attribute'">
                    @${selectedElement ? selectedElement.name : 'attribute'}
                  </span>
                </span>
              </div>
            </div>

            <div class="details-content">
              <!-- Element Info -->
              <div
                class="element-info"
                if.bind="selectedElement && selectedElement.aliases && selectedElement.aliases.length"
              >
                <div class="element-aliases">
                  <span class="aliases-label">Also known as:</span>
                  <span class="alias-list">${selectedElement.aliases.join(', ')}</span>
                </div>
              </div>

              <!-- Properties Sections -->
              <div class="properties-section" if.bind="selectedElement">
                <div class="section-header">
                  <span class="section-icon">‚ö°</span>
                  <span class="section-title">Bindables</span>
                  <span class="property-count" if.bind="selectedElement.bindables.length">(${selectedElement.bindables.length})</span>
                </div>
                <div class="section-content">
                  <div if.bind="!selectedElement.bindables.length" class="empty-state">No bindable properties</div>
                  <ul class="properties-list" else>
                    <li
                      repeat.for="row of getPropertyRows(selectedElement.bindables, propertyRowsRevision)"
                      class="property-item"
                      style="padding-left: ${row.depth * 16}px"
                    >
                      <div class="property-row">
                        <div
                          class="property-main ${row.property.canExpand ? 'expandable' : ''}"
                          click.trigger="handlePropertyRowClick(row.property, $event)"
                        >
                          <button
                            class="expand-button"
                            css="visibility: ${row.property.canExpand ? 'visible' : 'hidden'}"
                            click.trigger="togglePropertyExpansion(row.property)"
                          >
                            <svg
                              width="8"
                              height="8"
                              viewBox="0 0 8 8"
                              class="expand-icon ${row.property.isExpanded ? 'expanded' : ''}"
                            >
                              <path d="M2 2 L6 4 L2 6 Z" fill="currentColor" />
                            </svg>
                          </button>
                          <span class="property-name">${row.property.name}</span>
                          <span class="property-separator">:</span>
                          <span class="property-value-wrapper">
                            <span
                              if.bind="!row.property.isEditing"
                              class="property-value ${row.property.type} ${row.property.canEdit ? 'editable' : 'readonly'}"
                              dblclick.trigger="row.property.canEdit ? editProperty(row.property) : null"
                              title="${row.property.canEdit ? 'Double-click to edit' : 'Read-only property'}"
                            >
                              <span if.bind="row.property.type === 'string'">"</span>${row.property.value}<span
                                if.bind="row.property.type === 'string'"
                                >"</span
                              >
                            </span>

                            <select
                              if.bind="row.property.isEditing && row.property.type === 'boolean'"
                              class="property-editor"
                              value.bind="row.property.value ? 'true' : 'false'"
                              change.trigger="saveProperty(row.property, $event.target.value)"
                              blur.trigger="saveProperty(row.property, $event.target.value)"
                            >
                              <option value="true">true</option>
                              <option value="false">false</option>
                            </select>
                            <input
                              if.bind="row.property.isEditing && row.property.type !== 'boolean'"
                              class="property-editor"
                              type="text"
                              value.bind="row.property.value"
                              keydown.trigger="$event.code === 'Enter' ? saveProperty(row.property, $event.target.value) : ($event.code === 'Escape' ? cancelPropertyEdit(row.property) : null)"
                              blur.trigger="saveProperty(row.property, $event.target.value)"
                              placeholder="Enter ${row.property.type} value (ESC to cancel)"
                              focus.trigger="$event.target.select()"
                            />
                          </span>
                        </div>
                      </div>
                    </li>
                  </ul>
                </div>

                <div class="properties-separator"></div>

                <div class="section-header">
                  <span class="section-icon">üè†</span>
                  <span class="section-title">Properties</span>
                  <span class="property-count" if.bind="selectedElement.properties.length">(${selectedElement.properties.length})</span>
                </div>
                <div class="section-content">
                  <div if.bind="!selectedElement.properties.length" class="empty-state">No properties</div>
                  <ul class="properties-list" else>
                    <li
                      repeat.for="row of getPropertyRows(selectedElement.properties, propertyRowsRevision)"
                      class="property-item"
                      style="padding-left: ${row.depth * 16}px"
                    >
                      <div class="property-row">
                        <div
                          class="property-main ${row.property.canExpand ? 'expandable' : ''}"
                          click.trigger="handlePropertyRowClick(row.property, $event)"
                        >
                          <button
                            class="expand-button"
                            css="visibility: ${row.property.canExpand ? 'visible' : 'hidden'}"
                            click.trigger="togglePropertyExpansion(row.property)"
                          >
                            <svg
                              width="8"
                              height="8"
                              viewBox="0 0 8 8"
                              class="expand-icon ${row.property.isExpanded ? 'expanded' : ''}"
                            >
                              <path d="M2 2 L6 4 L2 6 Z" fill="currentColor" />
                            </svg>
                          </button>
                          <span class="property-name">${row.property.name}</span>
                          <span class="property-separator">:</span>
                          <span class="property-value-wrapper">
                            <span
                              if.bind="!row.property.isEditing"
                              class="property-value ${row.property.type} ${row.property.canEdit ? 'editable' : 'readonly'}"
                              dblclick.trigger="row.property.canEdit ? editProperty(row.property) : null"
                              title="${row.property.canEdit ? 'Double-click to edit' : 'Read-only property'}"
                            >
                              <span if.bind="row.property.type === 'string'">"</span>${row.property.value}<span
                                if.bind="row.property.type === 'string'"
                                >"</span
                              >
                            </span>

                            <select
                              if.bind="row.property.isEditing && row.property.type === 'boolean'"
                              class="property-editor"
                              value.bind="row.property.value ? 'true' : 'false'"
                              change.trigger="saveProperty(row.property, $event.target.value)"
                              blur.trigger="saveProperty(row.property, $event.target.value)"
                            >
                              <option value="true">true</option>
                              <option value="false">false</option>
                            </select>
                            <input
                              if.bind="row.property.isEditing && row.property.type !== 'boolean'"
                              class="property-editor"
                              type="text"
                              value.bind="row.property.value"
                              keydown.trigger="$event.code === 'Enter' ? saveProperty(row.property, $event.target.value) : ($event.code === 'Escape' ? cancelPropertyEdit(row.property) : null)"
                              blur.trigger="saveProperty(row.property, $event.target.value)"
                              placeholder="Enter ${row.property.type} value (ESC to cancel)"
                              focus.trigger="$event.target.select()"
                            />
                          </span>
                        </div>
                      </div>
                    </li>
                  </ul>
                </div>

                <div class="properties-separator" if.bind="selectedElement?.controller"></div>

                <div class="section-header" if.bind="selectedElement?.controller">
                  <span class="section-icon">üõ†Ô∏è</span>
                  <span class="section-title">Controller</span>
                  <span class="property-count" if.bind="selectedElement.controller.properties.length">(${selectedElement.controller.properties.length})</span>
                </div>
                <div class="section-content" if.bind="selectedElement?.controller">
                  <div if.bind="!selectedElement.controller.properties.length" class="empty-state">No controller fields</div>
                  <ul class="properties-list" else>
                    <li
                      repeat.for="row of getPropertyRows(selectedElement.controller.properties, propertyRowsRevision)"
                      class="property-item"
                      style="padding-left: ${row.depth * 16}px"
                    >
                      <div class="property-row">
                        <div
                          class="property-main ${row.property.canExpand ? 'expandable' : ''}"
                          click.trigger="handlePropertyRowClick(row.property, $event)"
                        >
                          <button
                            class="expand-button"
                            css="visibility: ${row.property.canExpand ? 'visible' : 'hidden'}"
                            click.trigger="togglePropertyExpansion(row.property)"
                          >
                            <svg
                              width="8"
                              height="8"
                              viewBox="0 0 8 8"
                              class="expand-icon ${row.property.isExpanded ? 'expanded' : ''}"
                            >
                              <path d="M2 2 L6 4 L2 6 Z" fill="currentColor" />
                            </svg>
                          </button>
                          <span class="property-name">${row.property.name}</span>
                          <span class="property-separator">:</span>
                          <span class="property-value-wrapper">
                            <span
                              if.bind="!row.property.isEditing"
                              class="property-value ${row.property.type} ${row.property.canEdit ? 'editable' : 'readonly'}"
                              dblclick.trigger="row.property.canEdit ? editProperty(row.property) : null"
                              title="${row.property.canEdit ? 'Double-click to edit' : 'Read-only property'}"
                            >
                              <span if.bind="row.property.type === 'string'">"</span>${row.property.value}<span
                                if.bind="row.property.type === 'string'"
                                >"</span
                              >
                            </span>

                            <select
                              if.bind="row.property.isEditing && row.property.type === 'boolean'"
                              class="property-editor"
                              value.bind="row.property.value ? 'true' : 'false'"
                              change.trigger="saveProperty(row.property, $event.target.value)"
                              blur.trigger="saveProperty(row.property, $event.target.value)"
                            >
                              <option value="true">true</option>
                              <option value="false">false</option>
                            </select>
                            <input
                              if.bind="row.property.isEditing && row.property.type !== 'boolean'"
                              class="property-editor"
                              type="text"
                              value.bind="row.property.value"
                              keydown.trigger="$event.code === 'Enter' ? saveProperty(row.property, $event.target.value) : ($event.code === 'Escape' ? cancelPropertyEdit(row.property) : null)"
                              blur.trigger="saveProperty(row.property, $event.target.value)"
                              placeholder="Enter ${row.property.type} value (ESC to cancel)"
                              focus.trigger="$event.target.select()"
                            />
                          </span>
                        </div>
                      </div>
                    </li>
                  </ul>
                </div>
              </div>

              <!-- Custom Attributes -->
              <div class="properties-section" if.bind="selectedElementAttributes && selectedElementAttributes.length">
                <div class="section-header">
                  <span class="section-icon">‚öôÔ∏è</span>
                  <span class="section-title">Custom Attributes</span>
                  <span class="property-count">(${selectedElementAttributes.length})</span>
                </div>
                <div class="section-content">
                  <div repeat.for="attribute of selectedElementAttributes" class="attribute-group">
                    <div class="attribute-header">
                      <span class="attribute-name">${attribute.name}</span>
                    </div>
                    <div class="attribute-content">
                      <div class="section-header">
                        <span class="section-icon">‚ö°</span>
                        <span class="section-title">Bindables</span>
                        <span class="property-count" if.bind="attribute.bindables.length">(${attribute.bindables.length})</span>
                      </div>
                      <div class="section-content">
                        <div if.bind="!attribute.bindables.length" class="empty-state">No bindable properties</div>
                        <ul class="properties-list" else>
                          <li
                            repeat.for="row of getPropertyRows(attribute.bindables, propertyRowsRevision)"
                            class="property-item"
                            style="padding-left: ${row.depth * 16}px"
                          >
                            <div class="property-row">
                              <div
                                class="property-main ${row.property.canExpand ? 'expandable' : ''}"
                                click.trigger="handlePropertyRowClick(row.property, $event)"
                              >
                                <button
                                  class="expand-button"
                                  css="visibility: ${row.property.canExpand ? 'visible' : 'hidden'}"
                                  click.trigger="togglePropertyExpansion(row.property)"
                                >
                                  <svg width="8" height="8" viewBox="0 0 8 8" class="expand-icon ${row.property.isExpanded ? 'expanded' : ''}">
                                    <path d="M2 2 L6 4 L2 6 Z" fill="currentColor" />
                                  </svg>
                                </button>
                                <span class="property-name">${row.property.name}</span>
                                <span class="property-separator">:</span>
                                <span class="property-value-wrapper">
                                  <span
                                    if.bind="!row.property.isEditing"
                                    class="property-value ${row.property.type} ${row.property.canEdit ? 'editable' : 'readonly'}"
                                    dblclick.trigger="row.property.canEdit ? editProperty(row.property) : null"
                                    title="${row.property.canEdit ? 'Double-click to edit' : 'Read-only property'}"
                                  >
                                    <span if.bind="row.property.type === 'string'">"</span>${row.property.value}<span if.bind="row.property.type === 'string'">"</span>
                                  </span>
                                  <select if.bind="row.property.isEditing && row.property.type === 'boolean'" class="property-editor" value.bind="row.property.value ? 'true' : 'false'" change.trigger="saveProperty(row.property, $event.target.value)" blur.trigger="saveProperty(row.property, $event.target.value)">
                                    <option value="true">true</option>
                                    <option value="false">false</option>
                                  </select>
                                  <input if.bind="row.property.isEditing && row.property.type !== 'boolean'" class="property-editor" type="text" value.bind="row.property.value" keydown.trigger="$event.code === 'Enter' ? saveProperty(row.property, $event.target.value) : ($event.code === 'Escape' ? cancelPropertyEdit(row.property) : null)" blur.trigger="saveProperty(row.property, $event.target.value)" placeholder="Enter ${row.property.type} value (ESC to cancel)" focus.trigger="$event.target.select()" />
                                </span>
                              </div>
                            </div>
                          </li>
                        </ul>
                      </div>

                      <div class="properties-separator"></div>

                      <div class="section-header">
                        <span class="section-icon">üè†</span>
                        <span class="section-title">Properties</span>
                        <span class="property-count" if.bind="attribute.properties.length">(${attribute.properties.length})</span>
                      </div>
                      <div class="section-content">
                        <div if.bind="!attribute.properties.length" class="empty-state">No properties</div>
                        <ul class="properties-list" else>
                          <li
                            repeat.for="row of getPropertyRows(attribute.properties, propertyRowsRevision)"
                            class="property-item"
                            style="padding-left: ${row.depth * 16}px"
                          >
                            <div class="property-row">
                              <div
                                class="property-main ${row.property.canExpand ? 'expandable' : ''}"
                                click.trigger="handlePropertyRowClick(row.property, $event)"
                              >
                                <button class="expand-button" css="visibility: ${row.property.canExpand ? 'visible' : 'hidden'}" click.trigger="togglePropertyExpansion(row.property)">
                                  <svg width="8" height="8" viewBox="0 0 8 8" class="expand-icon ${row.property.isExpanded ? 'expanded' : ''}">
                                    <path d="M2 2 L6 4 L2 6 Z" fill="currentColor" />
                                  </svg>
                                </button>
                                <span class="property-name">${row.property.name}</span>
                                <span class="property-separator">:</span>
                                <span class="property-value-wrapper">
                                  <span if.bind="!row.property.isEditing" class="property-value ${row.property.type} ${row.property.canEdit ? 'editable' : 'readonly'}" dblclick.trigger="row.property.canEdit ? editProperty(row.property) : null" title="${row.property.canEdit ? 'Double-click to edit' : 'Read-only property'}">
                                    <span if.bind="row.property.type === 'string'">"</span>${row.property.value}<span if.bind="row.property.type === 'string'">"</span>
                                  </span>
                                  <select if.bind="row.property.isEditing && row.property.type === 'boolean'" class="property-editor" value.bind="row.property.value ? 'true' : 'false'" change.trigger="saveProperty(row.property, $event.target.value)" blur.trigger="saveProperty(row.property, $event.target.value)">
                                    <option value="true">true</option>
                                    <option value="false">false</option>
                                  </select>
                                  <input if.bind="row.property.isEditing && row.property.type !== 'boolean'" class="property-editor" type="text" value.bind="row.property.value" keydown.trigger="$event.code === 'Enter' ? saveProperty(row.property, $event.target.value) : ($event.code === 'Escape' ? cancelPropertyEdit(row.property) : null)" blur.trigger="saveProperty(row.property, $event.target.value)" placeholder="Enter ${row.property.type} value (ESC to cancel)" focus.trigger="$event.target.select()" />
                                </span>
                              </div>
                            </div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div if.bind="isExternalTabActive" class="plugin-panel">
      <div class="plugin-panel-header">
        <div class="plugin-panel-title">
          <span class="plugin-panel-icon">${activeExternalIcon}</span>
          <div class="plugin-panel-copy">
            <h2 class="plugin-panel-heading">${activeExternalTitle}</h2>
            <p class="plugin-panel-description" if.bind="activeExternalDescription">${activeExternalDescription}</p>
          </div>
        </div>
        <div class="plugin-panel-actions">
          <button
            class="toolbar-button"
            click.trigger="refreshActiveExternalTab()"
            disabled.bind="isActiveExternalLoading"
          >
            ${isActiveExternalLoading ? 'Refreshing‚Ä¶' : 'Refresh'}
          </button>
        </div>
      </div>
      <div class="plugin-panel-body">
        <div if.bind="isActiveExternalLoading" class="plugin-state plugin-state--loading">
          <div class="empty-icon">‚è≥</div>
          <p>Loading panel data‚Ä¶</p>
        </div>
        <div if.bind="!isActiveExternalLoading && activeExternalError" class="plugin-state plugin-state--error">
          <div class="empty-icon">‚ö†Ô∏è</div>
          <p>${activeExternalError}</p>
          <button class="refresh-button" click.trigger="refreshActiveExternalTab()">Try Again</button>
        </div>
        <div if.bind="!isActiveExternalLoading && !activeExternalError && !activeExternalResult" class="plugin-state plugin-state--empty">
          <div class="empty-icon">üß©</div>
          <p>No panel data available yet.</p>
          <button class="refresh-button" click.trigger="refreshActiveExternalTab()">Refresh</button>
        </div>
        <div if.bind="activeExternalResult && !isActiveExternalLoading && !activeExternalError" class="plugin-content">
          <div class="plugin-summary" if.bind="activeExternalResult.summary">
            ${activeExternalResult.summary}
          </div>
          <div class="plugin-sections" if.bind="activeExternalResult.sections && activeExternalResult.sections.length">
            <section repeat.for="section of activeExternalResult.sections" class="plugin-section">
              <div class="plugin-section-header">
                <h3>${section.title || 'Details'}</h3>
                <p if.bind="section.description">${section.description}</p>
              </div>
              <dl class="plugin-rows" if.bind="section.rows && section.rows.length">
                <div repeat.for="row of section.rows" class="plugin-row">
                  <dt>
                    ${row.label || 'Value'}
                    <span class="plugin-row-hint" if.bind="row.hint">${row.hint}</span>
                  </dt>
                  <dd>
                    <pre if.bind="row.format === 'json'">${JSON.stringify(row.value, null, 2)}</pre>
                    <code if.bind="row.format === 'code'">${row.value}</code>
                    <span if.bind="!row.format || row.format === 'text'">${row.value}</span>
                  </dd>
                </div>
              </dl>
              <div class="plugin-table-wrapper" if.bind="section.table && section.table.rows && section.table.rows.length">
                <table class="plugin-table">
                  <thead if.bind="section.table.columns && section.table.columns.length">
                    <tr>
                      <th repeat.for="col of section.table.columns">${col}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr repeat.for="row of section.table.rows">
                      <td repeat.for="cell of row">${cell}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>
          </div>
          <div class="plugin-json" if.bind="activeExternalResult.data">
            <h3>Data</h3>
            <pre>${JSON.stringify(activeExternalResult.data, null, 2)}</pre>
          </div>
        </div>
      </div>
    </div>

  </main>
</div>
